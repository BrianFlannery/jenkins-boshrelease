
set -e # exit immediately if a simple command exits with a non-zero status
set -u # report the usage of uninitialized variables


set -x # verbose display of each command



export PACKAGE_NAME=$(basename $BOSH_COMPILE_TARGET)


# Available variables
# $BOSH_COMPILE_TARGET - where this package & spec'd source files are available (/var/vcap/data/compile/$PACKAGE_NAME)
# $BOSH_INSTALL_TARGET - where you copy/install files to be included in package (/var/vcap/packages/$PACKAGE_NAME)


# $PWD - $BOSH_COMPILE_TARGET



echo "DEBUG: cd ${BOSH_COMPILE_TARGET}/$PACKAGE_NAME" ;
cd ${BOSH_COMPILE_TARGET}/$PACKAGE_NAME ;
archive=`ls -lart | egrep '[.]war$' | tail -1 | awk '{print $NF}'` ;

cp -a $BOSH_COMPILE_TARGET/$PACKAGE_NAME/$archive ${BOSH_INSTALL_TARGET}/jenkins.war



mkdir -p ${BOSH_INSTALL_TARGET}/plugins

cp /var/vcap/packages/jenkins_plugins/*.* ${BOSH_INSTALL_TARGET}/plugins/ || :  # use  || : to not fail if the directory is empty

